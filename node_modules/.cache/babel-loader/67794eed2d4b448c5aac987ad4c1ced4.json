{"ast":null,"code":"import _regeneratorRuntime from\"/Users/everyone/Desktop/iPhone app/magic-light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/everyone/Desktop/iPhone app/magic-light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/everyone/Desktop/iPhone app/magic-light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _classCallCheck from\"/Users/everyone/Desktop/iPhone app/magic-light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/everyone/Desktop/iPhone app/magic-light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/everyone/Desktop/iPhone app/magic-light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/everyone/Desktop/iPhone app/magic-light/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{useState}from'react';import{IonHeader,IonToolbar,IonTitle,IonContent,IonList,IonIcon,IonAlert,IonTabs,IonTabBar,IonTabButton,IonRouterOutlet,IonLabel,IonRefresher,IonRefresherContent,IonSpinner,IonFooter}from'@ionic/react';import{chevronForward,wifiOutline,bluetoothOutline}from'ionicons/icons';import{isPlatform}from'@ionic/react';import{BluetoothLE}from'@ionic-native/bluetooth-le';import{BluetoothSerial}from'@ionic-native/bluetooth-serial';import{OpenNativeSettings}from'@ionic-native/open-native-settings';import'./index.css';var Main=/*#__PURE__*/function(_React$Component){_inherits(Main,_React$Component);var _super=_createSuper(Main);function Main(){_classCallCheck(this,Main);return _super.apply(this,arguments);}_createClass(Main,[{key:\"componentDidMount\",value:function componentDidMount(){var a=new scanForDevices(BluetoothLE,BluetoothSerial);a.bluetoothInitialize();a.scan(10);}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(IonContent,{class:\"main-page\"},/*#__PURE__*/React.createElement(IonHeader,null,/*#__PURE__*/React.createElement(IonToolbar,{class:\"main-toolbar\"},/*#__PURE__*/React.createElement(IonTitle,{class:\"main-toolbar-title\",size:\"large\"},\"Select A Device\"),/*#__PURE__*/React.createElement(IonIcon,{icon:chevronForward,class:\"next-button\",slot:\"end\"}))),/*#__PURE__*/React.createElement(IonSpinner,{class:\"single-refresh-spinner\"}),/*#__PURE__*/React.createElement(IonContent,{class:\"mid-content\"},/*#__PURE__*/React.createElement(IonList,{class:\"device-list\"}),/*#__PURE__*/React.createElement(IonRefresher,{slot:\"fixed\"},/*#__PURE__*/React.createElement(IonRefresherContent,{pullingText:\"Pull to refresh\",refreshingText:\"Refreshing...\"}))),/*#__PURE__*/React.createElement(IonFooter,{class:\"main-footer\"},/*#__PURE__*/React.createElement(IonToolbar,null,/*#__PURE__*/React.createElement(IonTabs,null,/*#__PURE__*/React.createElement(IonRouterOutlet,null),/*#__PURE__*/React.createElement(IonTabBar,{slot:\"bottom\",class:\"tab-bar\"},/*#__PURE__*/React.createElement(IonTabButton,{tab:\"Wifi\",href:\"/scan-devices/wifi\",disabled:true},/*#__PURE__*/React.createElement(IonIcon,{icon:wifiOutline,class:\"button-wifi\"}),/*#__PURE__*/React.createElement(IonLabel,{class:\"button-wifi button-wifi-label\"},\"Wifi\")),/*#__PURE__*/React.createElement(IonTabButton,{tab:\"Bluetooth\",href:\"/scan-devices/bluetooth\"},/*#__PURE__*/React.createElement(IonIcon,{icon:bluetoothOutline,class:\"button-bluetooth\"}),/*#__PURE__*/React.createElement(IonLabel,{class:\"button-bluetooth button-bluetooth-label\"},\"Bluetooth\")))))));}}]);return Main;}(React.Component);;export default Main;export var Alerts=function Alerts(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),continueAlert=_useState2[0],setContinueAlert=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),blNotEnabled=_useState4[0],setBlNotEnabled=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),errorConnecting=_useState6[0],setErrorConnecting=_useState6[1];return/*#__PURE__*/React.createElement(IonContent,null,/*#__PURE__*/React.createElement(IonAlert,{isOpen:continueAlert,header:'Continue?',message:'Are you sure you want to continue without selecting a device?',buttons:[{text:'Cancel'},{text:'Okay',handler:function handler(){console.log('continue ok');//move to next screen\n}}]}),/*#__PURE__*/React.createElement(IonAlert,{isOpen:blNotEnabled,header:'Error',message:'Bluetooth is not enabled. Please enable Bluetooth and try again.',buttons:[{text:'Settings',handler:function handler(){document.addEventListener(\"resume\",function(){var a=new scanForDevices(BluetoothLE,BluetoothSerial);a.bluetoothInitialize();a.scan(10);},false);console.log('opening settings');OpenNativeSettings.open(\"bluetooth\");}},{text:'Okay',handler:function handler(){var a=new scanForDevices(BluetoothLE,BluetoothSerial);a.bluetoothInitialize();a.scan(10);}}]}),/*#__PURE__*/React.createElement(IonAlert,{isOpen:errorConnecting,header:'Error',message:'There was an error connecting to the Bluetooth device. Make sure the device is turned on and try again.',buttons:['OK']}));};var scanForDevices=/*#__PURE__*/function(){function scanForDevices(ble,bls){var _this=this;_classCallCheck(this,scanForDevices);this.ble=ble;this.bls=bls;this.isCordova=void 0;this.devices=void 0;this.scan=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(timeout){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!_this.isCordova){_context.next=6;break;}//this.ble.stopScan(); //stop any current scans\nconsole.log(\"scanning!\");// this.ble.startScan( {\"allowDuplicates\": false, \"isConnectable\": true}  ).subscribe((result) => {\n//   if(result.status === \"scanResult\") {\n//     this.devices.push(result);\n//   }\n//   else if(result.status !== \"scanStarted\") {\n//     this.checkEnabled();\n//   }\n// });\n_this.bls.discoverUnpaired().then(function(result){console.log(result);});_context.next=5;return _this.timeout(timeout);case 5://this.ble.stopScan();\nconsole.log(\"stopped scan!\");case 6:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();this.bluetoothInitialize=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:document.createElement(\"ion-alert\");if(isPlatform('cordova')){_context2.next=5;break;}console.log(\"platform not cordova, BLE will not work!\");_this.isCordova=false;return _context2.abrupt(\"return\");case 5:_this.checkEnabled();_context2.next=8;return _this.ble.initialize({\"request\":true,\"statusReceiver\":false,\"restoreKey\":\"magic-light-ble\"}).subscribe(function(result){if(result.status===\"disabled\"){_this.checkEnabled();}});case 8:case\"end\":return _context2.stop();}}},_callee2);}));this.ble=ble;this.isCordova=true;this.devices=[];}_createClass(scanForDevices,[{key:\"checkEnabled\",value:function checkEnabled(){this.ble.isEnabled().then(isEnabled);//is bluetooth le enabled?\nthis.bls.isEnabled().then(isEnabled);//is bluetooth serial enabled?\nfunction isEnabled(isEnabled){if(!isEnabled.isEnabled){console.log(\"bluetooth **not** enabled!\");}}}},{key:\"addDevice\",value:function addDevice(device){var list=document.getElementsByClassName(\"device-list\")[0];//list.appendChild(document.createElement(\"bl-device\"));\n}},{key:\"timeout\",value:function timeout(s){return new Promise(function(resolve){return setTimeout(resolve,s*1000);});}}]);return scanForDevices;}();//https://www.npmjs.com/package/cordova-plugin-bluetoothle\n//startScan => connect => ...\n//                        disconnect => close\n//                        connect => disconnect => close => connect\n//::updating icons::\n//bond/unbond\n//discover","map":{"version":3,"sources":["/Users/everyone/Desktop/iPhone app/magic-light/src/pages/scan-devices/bluetooth/index.tsx"],"names":["React","useState","IonHeader","IonToolbar","IonTitle","IonContent","IonList","IonIcon","IonAlert","IonTabs","IonTabBar","IonTabButton","IonRouterOutlet","IonLabel","IonRefresher","IonRefresherContent","IonSpinner","IonFooter","chevronForward","wifiOutline","bluetoothOutline","isPlatform","BluetoothLE","BluetoothSerial","OpenNativeSettings","Main","a","scanForDevices","bluetoothInitialize","scan","Component","Alerts","continueAlert","setContinueAlert","blNotEnabled","setBlNotEnabled","errorConnecting","setErrorConnecting","text","handler","console","log","document","addEventListener","open","ble","bls","isCordova","devices","timeout","discoverUnpaired","then","result","createElement","checkEnabled","initialize","subscribe","status","isEnabled","device","list","getElementsByClassName","s","Promise","resolve","setTimeout"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { IonHeader, IonToolbar, IonTitle, IonContent, IonList, IonItem, IonIcon, IonAlert, IonTabs, IonTabBar, IonTabButton, IonRouterOutlet, IonLabel, IonRefresher, IonRefresherContent, IonSpinner, IonFooter} from '@ionic/react';\nimport { chevronForward, wifiOutline, bluetoothOutline, options } from 'ionicons/icons';\n\nimport { isPlatform } from '@ionic/react'\nimport { BluetoothLE, ScanStatus } from '@ionic-native/bluetooth-le';\nimport { BluetoothSerial } from '@ionic-native/bluetooth-serial';\nimport { OpenNativeSettings } from '@ionic-native/open-native-settings';\n\nimport './index.css';\n\nimport BluetoothDeviceItem from '../../../components/bluetooth/BluetoothDeviceItem';\nimport { BluetoothDevice } from '../../../interfaces/BluetoothDevice';\n\n\nclass Main extends React.Component {\n\n  componentDidMount() {\n    let a = new scanForDevices(BluetoothLE, BluetoothSerial);\n    a.bluetoothInitialize();\n    a.scan(10);\n  }\n\n  componentWillUnmount() {\n  }\n\n  render() {\n    return (\n      <IonContent class=\"main-page\">\n\n        <IonHeader>\n          <IonToolbar class=\"main-toolbar\">\n            <IonTitle class=\"main-toolbar-title\" size=\"large\">Select A Device</IonTitle>\n            <IonIcon icon={chevronForward} class=\"next-button\" slot=\"end\"></IonIcon>\n          </IonToolbar>\n        </IonHeader>\n        <IonSpinner class=\"single-refresh-spinner\"></IonSpinner>\n        \n        <IonContent class=\"mid-content\">\n          <IonList class=\"device-list\">\n          </IonList>\n          <IonRefresher slot=\"fixed\">\n              <IonRefresherContent\n                pullingText=\"Pull to refresh\"\n                refreshingText=\"Refreshing...\">\n              </IonRefresherContent>\n          </IonRefresher>\n        </IonContent>\n\n        <IonFooter class=\"main-footer\">\n          <IonToolbar>\n            <IonTabs>\n              <IonRouterOutlet></IonRouterOutlet>\n              <IonTabBar slot=\"bottom\" class=\"tab-bar\">\n                <IonTabButton tab=\"Wifi\" href=\"/scan-devices/wifi\" disabled={true}>\n                  <IonIcon icon={wifiOutline} class=\"button-wifi\"></IonIcon> \n                  <IonLabel class=\"button-wifi button-wifi-label\">Wifi</IonLabel>\n                </IonTabButton>\n                <IonTabButton tab=\"Bluetooth\" href=\"/scan-devices/bluetooth\">\n                  <IonIcon icon={bluetoothOutline} class=\"button-bluetooth\"></IonIcon>\n                  <IonLabel class=\"button-bluetooth button-bluetooth-label\">Bluetooth</IonLabel>\n\n                </IonTabButton>\n              </IonTabBar>\n            </IonTabs>\n          </IonToolbar>\n        </IonFooter>\n      </IonContent>\n    );\n  };\n};\nexport default Main;\n\nexport const Alerts = () => {\n\n  const [continueAlert, setContinueAlert] = useState(false);\n  const [blNotEnabled, setBlNotEnabled] = useState(false);\n  const [errorConnecting, setErrorConnecting] = useState(false);\n\n      return (\n      <IonContent>\n        <IonAlert\n          isOpen={continueAlert}\n          header={'Continue?'}\n          message={'Are you sure you want to continue without selecting a device?'}\n          buttons={[\n            { text: 'Cancel', },\n            {\n              text: 'Okay',\n              handler: () => {\n                console.log('continue ok'); //move to next screen\n              }\n            }\n          ]}\n        />\n        <IonAlert\n          isOpen={blNotEnabled}\n          header={'Error'}\n          message={'Bluetooth is not enabled. Please enable Bluetooth and try again.'}\n          buttons={[\n            {\n              text: 'Settings',\n              handler: () => {\n                document.addEventListener(\"resume\", function() {\n                  let a = new scanForDevices(BluetoothLE, BluetoothSerial);\n                  a.bluetoothInitialize();\n                  a.scan(10);\n                }, false);\n                console.log('opening settings');\n                OpenNativeSettings.open(\"bluetooth\");\n              }\n            },\n            {\n              text: 'Okay',\n              handler: () => {\n                let a = new scanForDevices(BluetoothLE, BluetoothSerial);\n                a.bluetoothInitialize();\n                a.scan(10);\n              }\n            }\n          ]\n        }\n        />\n        <IonAlert\n          isOpen={errorConnecting}\n          header={'Error'}\n          message={'There was an error connecting to the Bluetooth device. Make sure the device is turned on and try again.'}\n          buttons={['OK']}\n        />\n      </IonContent>\n      );\n}\n\nclass scanForDevices {\n  isCordova: boolean;\n  devices: ScanStatus[];\n\n  constructor(public ble: typeof BluetoothLE, public bls: typeof BluetoothSerial) {\n    this.ble = ble;\n    this.isCordova = true;\n    this.devices = [];\n   }\n\n   scan = async (timeout) => {\n    if(this.isCordova) {\n      //this.ble.stopScan(); //stop any current scans\n\n      console.log(\"scanning!\");\n\n      // this.ble.startScan( {\"allowDuplicates\": false, \"isConnectable\": true}  ).subscribe((result) => {\n      //   if(result.status === \"scanResult\") {\n      //     this.devices.push(result);\n      //   }\n      //   else if(result.status !== \"scanStarted\") {\n      //     this.checkEnabled();\n      //   }\n      // });\n\n      this.bls.discoverUnpaired().then(function(result) {\n        console.log(result);\n      });\n\n      await this.timeout(timeout);\n      //this.ble.stopScan();\n\n      console.log(\"stopped scan!\");\n    }\n  }\n\n  bluetoothInitialize = async () => {\n\n  \n    document.createElement(\"ion-alert\");\n\n    if (!isPlatform('cordova')) {\n      console.log(\"platform not cordova, BLE will not work!\");\n      this.isCordova = false;\n      return;\n    }\n\n    this.checkEnabled();\n\n    await this.ble.initialize( {\"request\": true, \"statusReceiver\": false, \"restoreKey\": \"magic-light-ble\"} ).subscribe((result) => {\n      if(result.status === \"disabled\") {\n        this.checkEnabled();\n      }\n    });\n  }\n\n  private checkEnabled() {\n    this.ble.isEnabled().then(isEnabled); //is bluetooth le enabled?\n    this.bls.isEnabled().then(isEnabled); //is bluetooth serial enabled?\n\n    function isEnabled(isEnabled){\n      if(!isEnabled.isEnabled) {\n        console.log(\"bluetooth **not** enabled!\");\n      }\n    }\n  }\n\n  private addDevice(device) {\n    let list = document.getElementsByClassName(\"device-list\")[0];\n    //list.appendChild(document.createElement(\"bl-device\"));\n  }\n\n  private timeout(s) {\n    return new Promise(resolve => setTimeout(resolve, s*1000));\n  } \n}\n\n//https://www.npmjs.com/package/cordova-plugin-bluetoothle\n\n//startScan => connect => ...\n//                        disconnect => close\n//                        connect => disconnect => close => connect\n//::updating icons::\n\n//bond/unbond\n//discover\n\n"]},"metadata":{},"sourceType":"module"}