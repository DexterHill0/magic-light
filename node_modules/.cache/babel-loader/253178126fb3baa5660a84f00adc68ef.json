{"ast":null,"code":"var _jsxFileName = \"/Users/everyone/Desktop/iPhone app/magic-light/src/pages/scan-devices/bluetooth/index.tsx\";\nimport React, { useState } from 'react';\nimport { IonHeader, IonToolbar, IonTitle, IonContent, IonList, IonIcon, IonAlert, IonTabs, IonTabBar, IonTabButton, IonRouterOutlet, IonLabel, IonRefresher, IonRefresherContent, IonSpinner, IonFooter } from '@ionic/react';\nimport { chevronForward, wifiOutline, bluetoothOutline } from 'ionicons/icons';\nimport { isPlatform } from '@ionic/react';\nimport { BluetoothLE } from '@ionic-native/bluetooth-le';\nimport { BluetoothSerial } from '@ionic-native/bluetooth-serial';\nimport { OpenNativeSettings } from '@ionic-native/open-native-settings';\nimport { toast } from \"../../../toast\";\nimport './index.css';\nimport BluetoothDeviceItem from '../../../components/bluetooth/BluetoothDeviceItem'; //import BluetoothDeviceItem from '../../../components/bluetooth/BluetoothDeviceItem';\n//import { BluetoothDevice } from '../../../interfaces/BluetoothDevice';\n\nclass Main extends React.Component {\n  componentDidMount() {\n    let a = new scanForDevices(BluetoothLE, BluetoothSerial);\n    a.test(); //a.bluetoothInitialize();\n    //a.scan(10);\n  }\n\n  componentWillUnmount() {}\n\n  componentWillMount() {}\n\n  render() {\n    return /*#__PURE__*/React.createElement(IonContent, {\n      class: \"main-page\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 38,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(IonHeader, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(IonToolbar, {\n      class: \"main-toolbar\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(IonTitle, {\n      class: \"main-toolbar-title\",\n      size: \"large\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 42,\n        columnNumber: 13\n      }\n    }, \"Select A Device\"), /*#__PURE__*/React.createElement(IonIcon, {\n      icon: chevronForward,\n      class: \"next-button\",\n      slot: \"end\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 43,\n        columnNumber: 13\n      }\n    }))), /*#__PURE__*/React.createElement(IonSpinner, {\n      class: \"single-refresh-spinner\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 46,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(IonContent, {\n      class: \"mid-content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(IonList, {\n      class: \"device-list\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(BluetoothDeviceItem, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(BluetoothDeviceItem, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(BluetoothDeviceItem, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 52,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(IonRefresher, {\n      slot: \"fixed\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(IonRefresherContent, {\n      pullingText: \"Pull to refresh\",\n      refreshingText: \"Refreshing...\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 15\n      }\n    }))), /*#__PURE__*/React.createElement(IonFooter, {\n      class: \"main-footer\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(IonToolbar, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(IonTabs, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(IonRouterOutlet, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(IonTabBar, {\n      slot: \"bottom\",\n      class: \"tab-bar\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(IonTabButton, {\n      tab: \"Wifi\",\n      href: \"/scan-devices/wifi\",\n      disabled: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(IonIcon, {\n      icon: wifiOutline,\n      class: \"button-wifi\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 19\n      }\n    }), /*#__PURE__*/React.createElement(IonLabel, {\n      class: \"button-wifi button-wifi-label\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 19\n      }\n    }, \"Wifi\")), /*#__PURE__*/React.createElement(IonTabButton, {\n      tab: \"Bluetooth\",\n      href: \"/scan-devices/bluetooth\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(IonIcon, {\n      icon: bluetoothOutline,\n      class: \"button-bluetooth\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 19\n      }\n    }), /*#__PURE__*/React.createElement(IonLabel, {\n      class: \"button-bluetooth button-bluetooth-label\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 19\n      }\n    }, \"Bluetooth\")))))));\n  }\n\n}\n\n;\nexport default Main;\nexport const Alerts = () => {\n  const [continueAlert, setContinueAlert] = useState(false);\n  const [blNotEnabled, setBlNotEnabled] = useState(false);\n  const [errorConnecting, setErrorConnecting] = useState(false);\n  return /*#__PURE__*/React.createElement(IonContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(IonAlert, {\n    isOpen: continueAlert,\n    header: 'Continue?',\n    message: 'Are you sure you want to continue without selecting a device?',\n    buttons: [{\n      text: 'Cancel'\n    }, {\n      text: 'Okay',\n      handler: () => {\n        console.log('continue ok'); //move to next screen\n      }\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(IonAlert, {\n    isOpen: blNotEnabled,\n    header: 'Error',\n    message: 'Bluetooth is not enabled. Please enable Bluetooth and try again.',\n    buttons: [{\n      text: 'Settings',\n      handler: () => {\n        document.addEventListener(\"resume\", function () {\n          let a = new scanForDevices(BluetoothLE, BluetoothSerial);\n          a.bluetoothInitialize();\n          a.scan(10);\n        }, false);\n        console.log('opening settings');\n        OpenNativeSettings.open(\"bluetooth\");\n      }\n    }, {\n      text: 'Okay',\n      handler: () => {\n        let a = new scanForDevices(BluetoothLE, BluetoothSerial);\n        a.bluetoothInitialize();\n        a.scan(10);\n      }\n    }],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(IonAlert, {\n    isOpen: errorConnecting,\n    header: 'Error',\n    message: 'There was an error connecting to the Bluetooth device. Make sure the device is turned on and try again.',\n    buttons: ['OK'],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 9\n    }\n  }));\n};\n\nclass scanForDevices {\n  constructor(ble, bls) {\n    this.ble = ble;\n    this.bls = bls;\n    this.isCordova = void 0;\n    this.devices = void 0;\n\n    this.scan = async timeout => {\n      if (this.isCordova) {\n        //this.ble.stopScan(); //stop any current scans\n        console.log(\"scanning!\"); // this.ble.startScan( {\"allowDuplicates\": false, \"isConnectable\": true}  ).subscribe((result) => {\n        //   if(result.status === \"scanResult\") {\n        //     this.devices.push(result);\n        //   }\n        //   else if(result.status !== \"scanStarted\") {\n        //     this.checkEnabled();\n        //   }\n        // });\n\n        this.bls.discoverUnpaired().then(function (result) {\n          console.log(result);\n        });\n        await this.timeout(timeout); //this.ble.stopScan();\n\n        console.log(\"stopped scan!\");\n      }\n    };\n\n    this.bluetoothInitialize = async () => {\n      if (!isPlatform('cordova')) {\n        console.log(\"platform not cordova, BLE will not work!\");\n        this.isCordova = false;\n        return;\n      }\n\n      this.checkEnabled(); // await this.ble.initialize( {\"request\": true, \"statusReceiver\": false, \"restoreKey\": \"magic-light-ble\"} ).subscribe((result) => {\n      //   if(result.status === \"disabled\") {\n      //     this.checkEnabled();\n      //   }\n      // });\n    };\n\n    this.ble = ble;\n    this.isCordova = true;\n    this.devices = [];\n  }\n\n  test() {\n    return toast(\"test\");\n  }\n\n  checkEnabled() {\n    //this.ble.isEnabled().then(isEnabled); //is bluetooth le enabled\n    this.bls.isEnabled().then(result => console.log(result)); //is bluetooth serial enabled\n\n    function isEnabled(s) {\n      console.log(s); // if(!isEnabled.) {\n      //   console.log(\"bluetooth **not** enabled!\");\n      // }\n    }\n  }\n\n  addDevice(device) {\n    let list = document.getElementsByClassName(\"device-list\")[0]; //list.appendChild(document.createElement(\"bl-device\"));\n  }\n\n  timeout(s) {\n    return new Promise(resolve => setTimeout(resolve, s * 1000));\n  }\n\n} //https://www.npmjs.com/package/cordova-plugin-bluetoothle\n//startScan => connect => ...\n//                        disconnect => close\n//                        connect => disconnect => close => connect\n//::updating icons::\n//bond/unbond\n//discover","map":{"version":3,"sources":["/Users/everyone/Desktop/iPhone app/magic-light/src/pages/scan-devices/bluetooth/index.tsx"],"names":["React","useState","IonHeader","IonToolbar","IonTitle","IonContent","IonList","IonIcon","IonAlert","IonTabs","IonTabBar","IonTabButton","IonRouterOutlet","IonLabel","IonRefresher","IonRefresherContent","IonSpinner","IonFooter","chevronForward","wifiOutline","bluetoothOutline","isPlatform","BluetoothLE","BluetoothSerial","OpenNativeSettings","toast","BluetoothDeviceItem","Main","Component","componentDidMount","a","scanForDevices","test","componentWillUnmount","componentWillMount","render","Alerts","continueAlert","setContinueAlert","blNotEnabled","setBlNotEnabled","errorConnecting","setErrorConnecting","text","handler","console","log","document","addEventListener","bluetoothInitialize","scan","open","constructor","ble","bls","isCordova","devices","timeout","discoverUnpaired","then","result","checkEnabled","isEnabled","s","addDevice","device","list","getElementsByClassName","Promise","resolve","setTimeout"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { IonHeader, IonToolbar, IonTitle, IonContent, IonList, IonIcon, IonAlert, IonTabs, IonTabBar, IonTabButton, IonRouterOutlet, IonLabel, IonRefresher, IonRefresherContent, IonSpinner, IonFooter} from '@ionic/react';\nimport { chevronForward, wifiOutline, bluetoothOutline } from 'ionicons/icons';\n\nimport { isPlatform } from '@ionic/react'\nimport { BluetoothLE, ScanStatus } from '@ionic-native/bluetooth-le';\nimport { BluetoothSerial } from '@ionic-native/bluetooth-serial';\nimport { OpenNativeSettings } from '@ionic-native/open-native-settings';\n\nimport { toast } from \"../../../toast\";\n\nimport './index.css';\nimport BluetoothDeviceItem from '../../../components/bluetooth/BluetoothDeviceItem';\n\n//import BluetoothDeviceItem from '../../../components/bluetooth/BluetoothDeviceItem';\n//import { BluetoothDevice } from '../../../interfaces/BluetoothDevice';\n\n\nclass Main extends React.Component {\n\n  componentDidMount() {\n    let a = new scanForDevices(BluetoothLE, BluetoothSerial);\n    a.test();\n    //a.bluetoothInitialize();\n    //a.scan(10);\n  }\n\n  componentWillUnmount() {\n    \n  }\n\n  componentWillMount() {\n    \n  }\n\n  render() {\n    return (\n      <IonContent class=\"main-page\">\n\n        <IonHeader>\n          <IonToolbar class=\"main-toolbar\">\n            <IonTitle class=\"main-toolbar-title\" size=\"large\">Select A Device</IonTitle>\n            <IonIcon icon={chevronForward} class=\"next-button\" slot=\"end\"></IonIcon>\n          </IonToolbar>\n        </IonHeader>\n        <IonSpinner class=\"single-refresh-spinner\"></IonSpinner>\n        \n        <IonContent class=\"mid-content\">\n          <IonList class=\"device-list\">\n            <BluetoothDeviceItem></BluetoothDeviceItem>\n            <BluetoothDeviceItem></BluetoothDeviceItem>\n            <BluetoothDeviceItem></BluetoothDeviceItem>\n          </IonList>\n          <IonRefresher slot=\"fixed\">\n              <IonRefresherContent\n                pullingText=\"Pull to refresh\"\n                refreshingText=\"Refreshing...\">\n              </IonRefresherContent>\n          </IonRefresher>\n        </IonContent>\n\n        <IonFooter class=\"main-footer\">\n          <IonToolbar>\n            <IonTabs>\n              <IonRouterOutlet></IonRouterOutlet>\n              <IonTabBar slot=\"bottom\" class=\"tab-bar\">\n                <IonTabButton tab=\"Wifi\" href=\"/scan-devices/wifi\" disabled={true}>\n                  <IonIcon icon={wifiOutline} class=\"button-wifi\"></IonIcon> \n                  <IonLabel class=\"button-wifi button-wifi-label\">Wifi</IonLabel>\n                </IonTabButton>\n                <IonTabButton tab=\"Bluetooth\" href=\"/scan-devices/bluetooth\">\n                  <IonIcon icon={bluetoothOutline} class=\"button-bluetooth\"></IonIcon>\n                  <IonLabel class=\"button-bluetooth button-bluetooth-label\">Bluetooth</IonLabel>\n\n                </IonTabButton>\n              </IonTabBar>\n            </IonTabs>\n          </IonToolbar>\n        </IonFooter>\n      </IonContent>\n    );\n  };\n};\nexport default Main;\n\nexport const Alerts = () => {\n\n  const [continueAlert, setContinueAlert] = useState(false);\n  const [blNotEnabled, setBlNotEnabled] = useState(false);\n  const [errorConnecting, setErrorConnecting] = useState(false);\n\n      return (\n      <IonContent>\n        <IonAlert\n          isOpen={continueAlert}\n          header={'Continue?'}\n          message={'Are you sure you want to continue without selecting a device?'}\n          buttons={[\n            { text: 'Cancel', },\n            {\n              text: 'Okay',\n              handler: () => {\n                console.log('continue ok'); //move to next screen\n              }\n            }\n          ]}\n        />\n        <IonAlert\n          isOpen={blNotEnabled}\n          header={'Error'}\n          message={'Bluetooth is not enabled. Please enable Bluetooth and try again.'}\n          buttons={[\n            {\n              text: 'Settings',\n              handler: () => {\n                document.addEventListener(\"resume\", function() {\n                  let a = new scanForDevices(BluetoothLE, BluetoothSerial);\n                  a.bluetoothInitialize();\n                  a.scan(10);\n                }, false);\n                console.log('opening settings');\n                OpenNativeSettings.open(\"bluetooth\");\n              }\n            },\n            {\n              text: 'Okay',\n              handler: () => {\n                let a = new scanForDevices(BluetoothLE, BluetoothSerial);\n                a.bluetoothInitialize();\n                a.scan(10);\n              }\n            }\n          ]\n        }\n        />\n        <IonAlert\n          isOpen={errorConnecting}\n          header={'Error'}\n          message={'There was an error connecting to the Bluetooth device. Make sure the device is turned on and try again.'}\n          buttons={['OK']}\n        />\n      </IonContent>\n      );\n}\n\nclass scanForDevices {\n  isCordova: boolean;\n  devices: any[];\n\n  constructor(public ble: typeof BluetoothLE, public bls: typeof BluetoothSerial) {\n    this.ble = ble;\n    this.isCordova = true;\n    this.devices = [];\n   }\n\n   test() {\n    return toast(\"test\");\n   }\n\n   scan = async (timeout) => {\n    if(this.isCordova) {\n      //this.ble.stopScan(); //stop any current scans\n\n      console.log(\"scanning!\");\n\n      // this.ble.startScan( {\"allowDuplicates\": false, \"isConnectable\": true}  ).subscribe((result) => {\n      //   if(result.status === \"scanResult\") {\n      //     this.devices.push(result);\n      //   }\n      //   else if(result.status !== \"scanStarted\") {\n      //     this.checkEnabled();\n      //   }\n      // });\n\n      this.bls.discoverUnpaired().then(function(result) {\n        console.log(result);\n      });\n\n      await this.timeout(timeout);\n      //this.ble.stopScan();\n\n      console.log(\"stopped scan!\");\n    }\n  }\n\n  bluetoothInitialize = async () => {\n    if (!isPlatform('cordova')) {\n      console.log(\"platform not cordova, BLE will not work!\");\n      this.isCordova = false;\n      return;\n    }\n\n    this.checkEnabled();\n\n    // await this.ble.initialize( {\"request\": true, \"statusReceiver\": false, \"restoreKey\": \"magic-light-ble\"} ).subscribe((result) => {\n    //   if(result.status === \"disabled\") {\n    //     this.checkEnabled();\n    //   }\n    // });\n  }\n\n  private checkEnabled() {\n    //this.ble.isEnabled().then(isEnabled); //is bluetooth le enabled\n    this.bls.isEnabled().then(result => console.log(result)); //is bluetooth serial enabled\n\n    function isEnabled(s){\n      console.log(s);\n      // if(!isEnabled.) {\n      //   console.log(\"bluetooth **not** enabled!\");\n      // }\n    }\n  }\n\n  private addDevice(device) {\n    let list = document.getElementsByClassName(\"device-list\")[0];\n    //list.appendChild(document.createElement(\"bl-device\"));\n  }\n\n  private timeout(s) {\n    return new Promise(resolve => setTimeout(resolve, s*1000));\n  } \n}\n\n//https://www.npmjs.com/package/cordova-plugin-bluetoothle\n\n//startScan => connect => ...\n//                        disconnect => close\n//                        connect => disconnect => close => connect\n//::updating icons::\n\n//bond/unbond\n//discover\n\n"]},"metadata":{},"sourceType":"module"}