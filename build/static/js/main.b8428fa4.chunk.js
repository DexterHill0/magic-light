(this["webpackJsonpmagic-light"]=this["webpackJsonpmagic-light"]||[]).push([[7],{71:function(e,n,t){e.exports=t(98)},77:function(e,n,t){var o={"./ion-action-sheet-ios.entry.js":[103,13],"./ion-action-sheet-md.entry.js":[104,14],"./ion-alert-ios.entry.js":[105,15],"./ion-alert-md.entry.js":[106,16],"./ion-app_8-ios.entry.js":[107,17],"./ion-app_8-md.entry.js":[108,18],"./ion-avatar_3-ios.entry.js":[109,35],"./ion-avatar_3-md.entry.js":[110,36],"./ion-back-button-ios.entry.js":[111,37],"./ion-back-button-md.entry.js":[112,38],"./ion-backdrop-ios.entry.js":[113,79],"./ion-backdrop-md.entry.js":[114,80],"./ion-button_2-ios.entry.js":[115,39],"./ion-button_2-md.entry.js":[116,40],"./ion-card_5-ios.entry.js":[117,41],"./ion-card_5-md.entry.js":[118,42],"./ion-checkbox-ios.entry.js":[119,43],"./ion-checkbox-md.entry.js":[120,44],"./ion-chip-ios.entry.js":[121,45],"./ion-chip-md.entry.js":[122,46],"./ion-col_3.entry.js":[123,81],"./ion-datetime_3-ios.entry.js":[124,23],"./ion-datetime_3-md.entry.js":[125,24],"./ion-fab_3-ios.entry.js":[126,47],"./ion-fab_3-md.entry.js":[127,48],"./ion-img.entry.js":[128,82],"./ion-infinite-scroll_2-ios.entry.js":[129,83],"./ion-infinite-scroll_2-md.entry.js":[130,84],"./ion-input-ios.entry.js":[131,49],"./ion-input-md.entry.js":[132,50],"./ion-item-option_3-ios.entry.js":[133,51],"./ion-item-option_3-md.entry.js":[134,52],"./ion-item_8-ios.entry.js":[135,53],"./ion-item_8-md.entry.js":[136,54],"./ion-loading-ios.entry.js":[137,55],"./ion-loading-md.entry.js":[138,56],"./ion-menu_3-ios.entry.js":[139,57],"./ion-menu_3-md.entry.js":[140,58],"./ion-modal-ios.entry.js":[141,19],"./ion-modal-md.entry.js":[142,20],"./ion-nav_2.entry.js":[143,31],"./ion-popover-ios.entry.js":[144,21],"./ion-popover-md.entry.js":[145,22],"./ion-progress-bar-ios.entry.js":[146,59],"./ion-progress-bar-md.entry.js":[147,60],"./ion-radio_2-ios.entry.js":[148,61],"./ion-radio_2-md.entry.js":[149,62],"./ion-range-ios.entry.js":[150,63],"./ion-range-md.entry.js":[151,64],"./ion-refresher_2-ios.entry.js":[152,25],"./ion-refresher_2-md.entry.js":[153,26],"./ion-reorder_2-ios.entry.js":[154,33],"./ion-reorder_2-md.entry.js":[155,34],"./ion-ripple-effect.entry.js":[156,85],"./ion-route_4.entry.js":[157,65],"./ion-searchbar-ios.entry.js":[158,66],"./ion-searchbar-md.entry.js":[159,67],"./ion-segment_2-ios.entry.js":[160,68],"./ion-segment_2-md.entry.js":[161,69],"./ion-select_3-ios.entry.js":[162,70],"./ion-select_3-md.entry.js":[163,71],"./ion-slide_2-ios.entry.js":[164,86],"./ion-slide_2-md.entry.js":[165,87],"./ion-spinner.entry.js":[166,29],"./ion-split-pane-ios.entry.js":[167,88],"./ion-split-pane-md.entry.js":[168,89],"./ion-tab-bar_2-ios.entry.js":[169,72],"./ion-tab-bar_2-md.entry.js":[170,73],"./ion-tab_2.entry.js":[171,32],"./ion-text.entry.js":[172,74],"./ion-textarea-ios.entry.js":[173,75],"./ion-textarea-md.entry.js":[174,76],"./ion-toast-ios.entry.js":[175,77],"./ion-toast-md.entry.js":[176,78],"./ion-toggle-ios.entry.js":[177,27],"./ion-toggle-md.entry.js":[178,28],"./ion-virtual-scroll.entry.js":[179,90]};function i(e){if(!t.o(o,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=o[e],i=n[0];return t.e(n[1]).then((function(){return t(i)}))}i.keys=function(){return Object.keys(o)},i.id=77,e.exports=i},79:function(e,n,t){var o={"./ion-icon.entry.js":[183,93]};function i(e){if(!t.o(o,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=o[e],i=n[0];return t.e(n[1]).then((function(){return t(i)}))}i.keys=function(){return Object.keys(o)},i.id=79,e.exports=i},94:function(e,n,t){},96:function(e,n,t){},97:function(e,n,t){"use strict";t.r(n);var o=t(0),i=t.n(o),r=t(7),s=t(4),a=t(64),c=(t(84),t(85),t(86),t(87),t(88),t(89),t(90),t(91),t(92),t(93),t(5)),l=t(6),u=t(9),d=t(8),m=t(12),p=(t(94),t(18)),y=t(38),h=t(69),f=t(10),b=t.n(f),j=t(17),v=t(32),E=t(67),g=t(68),_=t.n(g),k=(t(96),function(e){Object(u.a)(t,e);var n=Object(d.a)(t);function t(e){var o;return Object(c.a)(this,t),(o=n.call(this,e)).updateIcons=function(){var e=Array.prototype.slice.call(document.getElementsByClassName("device-list")[0].children).findIndex((function(e){return e.id===o.props.mac})),n=document.getElementsByClassName("connecting-icons")[e].style,t=document.getElementsByClassName("connecting-spinner")[e].style;switch(o.props.state()){case"not_connected":t.opacity=0,n.color="var(--ion-color-danger)",n.opacity=1,o.setState({icon:m.i});break;case"connecting":t.opacity=1,n.opacity=0,o.setState({icon:""});break;case"connected":t.opacity=0,n.opacity=1,n.color="var(--ion-color-success)",o.setState({icon:m.d})}},o.rerender=function(){o.updateIcons()},o.wait=Object(j.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.props.onClick(o.props.mac),o.rerender();case 2:case"end":return e.stop()}}),e)}))),o.state={icon:m.i},o}return Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement(s.h,{lines:"none",class:"item-container",id:this.props.mac,onClick:this.wait},i.a.createElement(s.c,{slot:"start",class:"bluetooth-icon-container"},i.a.createElement(s.g,{icon:m.b,class:"bluetooth-icon"})),i.a.createElement(s.c,{slot:"end",class:"connecting-icons-container"},i.a.createElement(s.g,{icon:this.state.icon,class:"connecting-icons"}),i.a.createElement(s.n,{name:"dots",class:"connecting-spinner"})),i.a.createElement(s.i,null,i.a.createElement("div",{className:"device-name"},this.props.name?this.props.name:"Unknown"),i.a.createElement("div",{className:"device-mac"},this.props.mac)))}}]),t}(i.a.Component)),O=function(){var e={},n={},t=[],r=[],s=new w,a=function(){var e=Object(j.a)(b.a.mark((function e(n){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.scan(n);case 2:e.sent.forEach((function(e){c(e)||u(e,!0)}));case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),c=function(e){var n=!1;return t.forEach((function(t){e.address===t.props.mac&&(n=!0)})),n},l=function(e){t.forEach((function(t){"connecting"!==t.props.state()&&"connected"!==t.props.state()||t.props.mac===e||(d(t.props.mac,"not_connected"),n[t.props.mac].current.rerender())}))},u=function(s,a){""!==e[s.address]&&(a&&(r.push.apply(r,Object(h.a)(s.advertisement.serviceUuids)),e=Object(y.a)(Object(y.a)({},e),{},Object(p.a)({},s.address,s.advertisement.isConnectable?"not_connected":"connected"))),n=Object(y.a)(Object(y.a)({},n),{},Object(p.a)({},s.address,Object(o.createRef)())),t.push(i.a.createElement(k,{key:s.address,ref:n[s.address],mac:s.address,name:s.name,onClick:function(e){return function(e){d(e,"connecting"),l(e)}(e)},state:function(){return e[s.address]}})))},d=function(n,t){e[n]=t};return{deviceItems:t,bluetoothInitialize:function(){s.initialize()},scan:a}},w=function(){function e(){Object(c.a)(this,e),this.isEnabled=void 0,this.devices=[],this.isEnabled=!1}return Object(l.a)(e,[{key:"initialize",value:function(){var e=this;v.a.initialize({request:!0,statusReceiver:!0,restoreKey:"magic-light-ble"}).subscribe((function(n){"disabled"==n.status?(e.isEnabled=!1,console.log("1"),document.addEventListener("resume",e.onResume,!0),e.alert("Error","","Bluetooth is not enabled. Please enable Bluetooth and try again.",[{text:"Settings",handler:function(){E.a.open("bluetooth")}},{text:"Okay",handler:function(){e.onResume()}}])):e.isEnabled=!0})),v.a.stopScan()}},{key:"scan",value:function(){var e=Object(j.a)(b.a.mark((function e(n){var t=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isEnabled){e.next=5;break}return v.a.startScan({allowDuplicates:!1}).subscribe((function(e){"scanResult"===e.status&&t.pushIfNotExists(e)})),e.next=4,this.timeout(n);case 4:v.a.stopScan().then((function(e){e.status}));case 5:return e.abrupt("return",this.devices);case 6:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"pushIfNotExists",value:function(e){var n=0;this.devices.length>0?(this.devices.forEach((function(t){_()(e,t)||n++})),n>=this.devices.length&&this.devices.push(e)):this.devices.push(e)}},{key:"alert",value:function(e,n,t,o){var i=document.createElement("ion-alert");return i.header=e,i.subHeader=n,i.message=t,i.buttons=o,document.body.appendChild(i),i.present()}},{key:"timeout",value:function(e){return new Promise((function(n){return setTimeout(n,1e3*e)}))}},{key:"onResume",value:function(){var e=this;console.log("here1"),v.a.isEnabled().then((function(n){console.log("here2"),n.isEnabled&&(console.log("here3"),e.isEnabled=!0,document.removeEventListener("resume",e.onResume),console.log("here4"))}))}}]),e}(),x=O(),C=function(e){Object(u.a)(t,e);var n=Object(d.a)(t);function t(){var e;Object(c.a)(this,t);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(e=n.call.apply(n,[this].concat(i)))._=x,e.state={devices:[]},e}return Object(l.a)(t,[{key:"componentDidMount",value:function(){this.continueHandler(),this._.bluetoothInitialize()}},{key:"componentWillUnmount",value:function(){}},{key:"alert",value:function(e,n,t,o){var i=document.createElement("ion-alert");return i.header=e,i.subHeader=n,i.message=t,i.buttons=o,document.body.appendChild(i),i.present()}},{key:"continueHandler",value:function(){0==this.state.devices.length&&this.alert("Continue?","","Are you sure you want to continue without selecting a device?",[{text:"Cancel"},{text:"Okay",handler:function(){console.log("continue ok")}}])}},{key:"render",value:function(){var e=this;return i.a.createElement(s.d,{class:"main-page",scrollY:!1},i.a.createElement(s.f,null,i.a.createElement(s.s,{class:"main-toolbar"},i.a.createElement(s.r,{class:"main-toolbar-title",size:"large"},"Select A Device"),i.a.createElement(s.g,{icon:m.f,class:"next-button",slot:"end",onClick:function(){return e.continueHandler}}))),i.a.createElement(s.n,{class:"single-refresh-spinner"}),i.a.createElement(s.d,{class:"mid-content"},i.a.createElement(s.k,{class:"device-list"},this.state.devices.map((function(e){return e})))),i.a.createElement(s.e,{class:"footer"},i.a.createElement(s.s,{class:"footer-toolbar"},i.a.createElement(s.q,null,i.a.createElement(s.m,null),i.a.createElement(s.o,{slot:"bottom",class:"tab-bar"},i.a.createElement(s.p,{tab:"Wifi",href:"/scan-devices/wifi",disabled:!0},i.a.createElement(s.g,{icon:m.q,class:"button-wifi"}),i.a.createElement(s.i,{class:"button-wifi button-wifi-label"},"Wifi")),i.a.createElement(s.p,{tab:"Bluetooth",href:"/scan-devices/bluetooth"},i.a.createElement(s.g,{icon:m.b,class:"button-bluetooth"}),i.a.createElement(s.i,{class:"button-bluetooth button-bluetooth-label"},"Bluetooth")))))))}}]),t}(i.a.Component),N=function(e){Object(u.a)(t,e);var n=Object(d.a)(t);function t(){return Object(c.a)(this,t),n.apply(this,arguments)}return t}(i.a.Component);n.default=function(){return i.a.createElement(s.b,null,i.a.createElement(a.a,null,i.a.createElement(s.l,null,i.a.createElement(s.m,null,i.a.createElement(r.c,{path:"/scan-devices/bluetooth",component:C,exact:!0}),i.a.createElement(r.c,{path:"/scan-devices/wifi",component:N,exact:!0}),i.a.createElement(r.c,{path:"/",render:function(){return i.a.createElement(r.b,{to:"/scan-devices/bluetooth"})},exact:!0})))))}},98:function(e,n,t){"use strict";t.r(n);var o=t(0),i=t.n(o),r=t(36),s=t.n(r);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));!function(){var e=t(97).default;s.a.render(i.a.createElement(e,null),document.getElementById("root"))}(),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[71,9,12]]]);
//# sourceMappingURL=main.b8428fa4.chunk.js.map